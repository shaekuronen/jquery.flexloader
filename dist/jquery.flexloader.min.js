/*
 *  jQuery Flexloader - v0.3.1
 *  Lazyload Flexslider slides, optionally using Picturefill
 *  http://shaekuronen.github.io/jquery.flexloader
 *
 *  Made by Shae Kuronen
 *  Under MIT License
 */
!function(a){a.flexloader=function(b,c){function d(b,c){this.flexslider=b,this.current_slide=0,this.next_slide=0,this.prev_slide=0,this.last_slide=0,this.visible_slides=0,this.offset=0,this.slide_ids=[],this.$slides=a(this.flexslider.slides),this.options=a.extend({picturefill:!1,background_images:!1,class_name:"flexloader-background-image-loaded"},c),this.offset="undefined"!=typeof this.flexslider.move?this.flexslider.move:1,this.current_slide=this.flexslider.currentSlide,this.last_slide=this.flexslider.last,this.visible_slides="undefined"!=typeof this.flexslider.visible?this.calculate_visible_items():0,this.get_current_slides(),this.get_next_slides(),this.get_prev_slides(),this.init()}return d.prototype={init:function(){var a=this;this.options.picturefill===!0?(a.load_picturefill_slides(this.slide_ids),a.load_picturefill_cloned_slides()):this.options.background_images===!0?(a.load_background_image_slides(this.slide_ids),a.load_background_image_clone_slides()):(a.load_slides(this.slide_ids),a.load_cloned_slides())},calculate_visible_items:function(){var a,b;return a=void 0===this.flexslider.viewport?this.flexslider.width():this.flexslider.viewport.width(),b=this.flexslider.vars.itemWidth+this.flexslider.vars.itemMargin,Math.floor(a/b)},get_current_slides:function(){var a,b=this.current_slide*this.offset,c=b+this.visible_slides;for(a=b;c>=a;a++)this.slide_ids.push(a)},get_next_slides:function(){var a,b=this.current_slide*this.offset+this.visible_slides,c=b+this.offset;if(this.current_slide===this.last_slide)this.slide_ids.push(0);else for(a=c;a>b;a--)this.slide_ids.push(a)},get_prev_slides:function(){var a,b,c,d,e;if(0===this.current_slide)for(a=this.last_slide*this.offset+this.visible_slides,b=a+this.offset,e=a;b>e;e++)this.slide_ids.push(e);else for(c=this.current_slide*this.offset,d=c-this.offset,e=d;c>e;e++)this.slide_ids.push(e)},load_slides:function(b){var c=this;a(b).each(function(d){var e,f,g=b[d],h=a(c.$slides[g]);e=h.find("img").attr("src"),f=h.find("img").attr("data-original"),"undefined"!==f&&e!==f&&h.find("img").attr("src",f)})},load_cloned_slides:function(){a(this.flexslider).find(".clone").length>0&&a(this.flexslider).find(".clone").each(function(){var b,c,d=a(this).find("img");b=d.attr("src"),c=d.attr("data-original"),"undefined"!==c&&b!==c&&d.attr("src",c)})},load_picturefill_slides:function(b){var c=this;a(b).each(function(d){var e,f,g,h,i=b[d];e=a(c.$slides[i]).find("[data-picture]"),f=a(e).find("span").attr("data-src"),g=a(e).find("span").attr("data-original"),"undefined"!==g&&f!==g&&(h=a(e).find("span"),a.each(h,function(b){var c=a(h[b]),d=c.attr("data-original");c.attr("data-src",d),c.find("img").length>0&&c.find("img").attr("src",d)}))})},load_picturefill_cloned_slides:function(){a(this.flexslider).find(".clone").length>0&&a(this.flexslider).find(".clone").each(function(){var b,c,d,e,f=a(this);b=f.find("[data-picture]"),c=a(b).find("span").attr("data-src"),d=a(b).find("span").attr("data-original"),"undefined"!==d&&c!==d&&(e=a(b).find("span"),a.each(e,function(b){var c=a(e[b]),d=c.attr("data-original");c.attr("data-src",d),c.find("img").length>0&&c.find("img").attr("src",d)}))})},load_background_image_slides:function(b){var c=this;a(b).each(function(b,d){a(c.$slides[d]).addClass(c.options.class_name)})},load_background_image_clone_slides:function(){var b=this;a(b.flexslider).find(".clone").length>0&&a(b.flexslider).find(".clone").each(function(c,d){a(d).addClass(b.options.class_name)})}},a.data(b,"plugin_flexloader")?void 0:(a.data(b,"plugin_flexloader"),new d(b,c))}}(jQuery);